<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Debug Test</title>
</head>
<body>
    <h1>Testing Digital Content Builder</h1>
    <div id="results"></div>

    <button onclick="testHealth()">Test Health</button>
    <button onclick="testBuilder()">Test Builder Modal</button>
    <button onclick="testGeneration()">Test Content Generation</button>

    <script src="app.js"></script>
    <script>
        const results = document.getElementById('results');

        function log(message) {
            results.innerHTML += `<p>${new Date().toISOString()}: ${message}</p>`;
            console.log(message);
        }

        function testHealth() {
            log('Testing health endpoint...');
            fetch('http://localhost:5555/api/health')
                .then(r => r.json())
                .then(data => log('Health: ' + JSON.stringify(data)))
                .catch(err => log('Error: ' + err));
        }

        function testBuilder() {
            log('Testing showBuilderModal...');
            try {
                if (typeof showBuilderModal === 'function') {
                    showBuilderModal('ebook');
                    log('Modal function called successfully');
                } else {
                    log('ERROR: showBuilderModal is not defined');
                }
            } catch(e) {
                log('Error calling modal: ' + e.message);
            }
        }

        function testGeneration() {
            log('Testing content generation...');
            if (typeof generateContent === 'function') {
                generateContent('Test prompt', 'ebook')
                    .then(result => log('Generated: ' + result))
                    .catch(err => log('Generation error: ' + err));
            } else {
                log('ERROR: generateContent is not defined');
            }
        }

        // Check what's loaded
        window.addEventListener('DOMContentLoaded', () => {
            log('Page loaded');
            log('showBuilderModal defined: ' + (typeof showBuilderModal !== 'undefined'));
            log('builders object defined: ' + (typeof builders !== 'undefined'));
            log('generateContent defined: ' + (typeof generateContent !== 'undefined'));
        });
    </script>
</body>
</html>